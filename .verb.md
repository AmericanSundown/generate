## Quickstart example

The easiest way to get started is to create a generator that exports a function. To do so, create a `generator.js` file, and add the following code:

```js
module.exports = function(app) {
  app.task('default', function(cb) {
    console.log('task > default');
    cb();
  });

  app.task('foo', function(cb) {
    console.log('task > foo');
    cb();
  });
};
```

Now, in the command line run `gen` to execute the `default` task. If all is successful you should see the line: `task > default`. 

Next, try running `gen foo` to execute the `foo` task.

## What is generate?

Generate is a fast, composable, highly-extendable project generator with an unobtrusive CLI and a user-friendly and expressive API.

### Feature Highlights

- [x] Run local or globally-installed generators 
- [x] Run sub-generators using simple dot-notation. Supports any level of nesting!
- [x] Run [gulp][]-style "tasks" and uses some of the same underlying libraries as gulp
- [x] Built on [assemble-core][] with support for both [gulp][] and [assemble][] plugins
- [x] Generators can extend and use other generators
- [x] Generators, sub-generators and tasks can be run by command line, API, or both.
- [x] Run tasks from any generator or sub-generator, programmatically or via CLI 
- [x] Easy to add functionality and features to generate using via plugins
- [x] Supports any template engine
- [x] First class support for template collections, including pagination, sorting, groups, and more.
- [x] supports middleware that can be run on all files or specific files, and at specific points during the _build process_ (like `onLoad`, `preRender`, `postRender`, etc) 

## Getting started

- [Install](#install)
- [Overview](#overview)
- [Tasks](#tasks)
- [Generators](#generators)
- [sub-generators](#sub-generators)

### Install

To get started, you'll first need to install `generate` globally using [npm][], along with any generators you'd like to run.

**Install Generate**

{%= include("install-global") %}

### Overview

### Tasks intro

Tasks are powered by [bach][] by [@phated](https://github.com/phated) and [composer][] by [@doob](https://github.com/doowb), and they work exactly the same way as [gulp][] tasks.

**Register tasks:**

```js
gen.task('foo', function() {
  // do stuff
});

gen.task('bar', function(cb) {
  // optional callback
  cb();
});
```

**Run tasks:**

Run task `foo`:

```js
gen.build('foo', function(err) {
  if (err) throw err;
});
```

Run tasks `foo` and `bar`:

```js
gen.build(['foo', 'bar'], function(err) {
  if (err) throw err;
});
```

**Task CLI**

Run task `foo` from the command line:

```sh
$ gen foo
```

Run tasks `foo` and `bar` from the command line:

```sh
$ gen foo bar
```

### Generators intro

Generators are functions that can be used to wrap tasks or other code in a highly decoupled and reusable way.

**Register generators:**

```js
gen.register('project', function(app) {
  app.task('readme', function() {
    return app.src('readme.tmpl')
      .pipe(app.dest(function() {
        file.basename = 'reamde.md';
        return process.cwd();
      });
  });

  app.task('readme', function() {
    return app.src('readme.tmpl')
      .pipe(app.dest(function() {
        file.basename = 'reamde.md';
        return process.cwd();
      });
  });

  app.task('default', ['readme']);
});
```

Note that generators may also be registered with the `.generator` method. The `.register` and `.generator` methods both accomplish the same goal _with one crucial difference_:

- `.register` lazily requires and/or invokes the generator function 
- `.generator` immediately requires and/or invokes the generator function

**Run generators and their tasks:**

Run the default task in generator `project`:

```js
gen.generate('project', function(err) {
  if (err) throw err;
});

// or
gen.generate('project', ['default'], function(err) {
  if (err) throw err;
});

// or
gen.generate('project:default', function(err) {
  if (err) throw err;
});
```

Run tasks `foo` and `bar` on generator `project`

```js
gen.generate('project', ['foo', 'bar'], function(err) {
  if (err) throw err;
});

// or
gen.generate('project:foo,bar', function(err) {
  if (err) throw err;
});
```

**Generator CLI**

Run the default task on generator `project` from the command line:

```sh
$ gen project
# or
$ gen project:default
```

Run tasks `foo` and `bar` on generator `project` from the command line:

```sh
$ gen project:foo,bar
```

## Common mistakes

### Wrong context

Make sure tasks and generators are defined on the correct instance. The example below illustrates this point. 

_(In sub-generator `bar`, task `a` is incorrectly defined on `app` (the parent generator. Of course, you can do this if you want, but it's usually done by accident.)_

```js
gen.register('foo', function(foo) {
  foo.register('bar', function(bar) {
    // WRONG
    foo.task('a', function() {});

    // CORRECT
    bar.task('b', function() {});
  });
});
```

### Invoking a generator from itself

For example, invoking the `default` generator from inside the `default` generator will cause infinite recursion.

```js
gen.register('default', function(app) {
  // wrong
  app.invoke('default');

  // correct
  app.invoke('any-other-generator');
});
```

### Wrong cwd

Whenever possible, to ensure that cwd is set correctly for a generator, do this:

```js
app.register('foo', 'foo/generator.js');
```

Instead of this:

```js
app.register('foo', require('./foo/generator.js'));
```

Both of these will work, but in the first example, generate will automatically detect the `cwd`. In the second example the `cwd` would need to be explicitly defined.


## API
{%= apidocs("index.js") %}

### Task API
{%%= depdocs("composer", "index.js") %}

### File System API
{%%= depdocs("assemble-fs", "index.js") %}


## CLI

The top level command for invoking generate from the command line is `gen`:

```sh
$ gen 
```

**Tasks or generators**

The `gen` command may be followed by the names of one or more tasks or generators:

```sh
$ gen <generators and tasks>
```

**Options**

Options flags are prefixed with `--` (or `-` for short flags). 

```sh
$ gen <generators and tasks> [options]
```

### Commands
_(TODO)_

## Authoring generators
_(TODO)_

## Conventions

### Template naming conventions

**Dotfiles**

Dotfile templates are prefixed with `_`. For example, a `.gitignore` template should be named `_gitignore`. 

**Manifests**

Package manifests, like `package.json`, `bower.json`, etc. are prefixed with `$` to prevent them from showing up in searches. For example, a `package.json` template should be named `$package.json`.


### Generator naming conventions

**Do**

Use `generate-` as the prefix, followed by any words of your choosing to describe the purpose of the generator.

**Don't**

Use `generator-` as the prefix, since the word `generator` is already associated with yeoman.

## TODO

- [ ] create and publish generators (we created a handful of generators that we've been using locally, these will be published shortly)
- [ ] CLI docs (started)
- [ ] User help (e.g. when the user does `gen help` or just `gen`)
- [ ] API docs
- [ ] Generator guidelines and conventions

### Why use generate instead of X?

Since [Google's Yeoman][] is probably the most widely recognized project generator in node.js, it's probably easiest to  Generate is similar to yeoman in that both tools can be used to "scaffold out a project", but the two projects approach this challenge very differently.

- Generate is open source and MIT licensed.
- Designed from the ground-up to be a faster, more extensible alternative to the current dominent solutions.
- Generate has an expressive, imperitive API that is strongly influenced by great libraries such as gulp and express.
- Well-tested, _with more than [1,000 unit tests](./test)._ 

**Comparison to Google's Yeoman**

| Feature | Google's Yeoman | Generate |
| --- | --- | --- |
| License | BSD-2-Clause Â© Google | MIT |
| CLI                       | yes | yes |
| API                       | yes | yes |
| Tasks                     | no | yes |
| Generators                | yes | yes |
| Sub-generators            | yes | yes |
| "Shared instances"        | yes | yes |
| Template rendering        | basic | any engine |
| Template collections      | no | yes |
| Supports gulp plugins     | no | yes |
| Supports assemble plugins | no | yes |
| Register helpers | no | yes |
| Async helpers | no | yes |
| Routes | no | yes |
| Middleware | no | yes |
| Instance plugins | no | yes |
| Pipeline plugins (streams) | no | yes |
| Config store | yes | yes |
